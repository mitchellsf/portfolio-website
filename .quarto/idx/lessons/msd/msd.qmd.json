{"title":"Mass-Spring-Damper System","markdown":{"yaml":{"title":"Mass-Spring-Damper System"},"headingText":"Lesson Scope","containsRefs":false,"markdown":"\n\n\nThis lesson supplements an undergraduate course in differential equations by using the mass-spring-damper (MSD) model to connect second-order linear ODEs to engineering vibration problems.\n\nYou will:\n\n- connect common engineering examples to the MSD model,\n- derive the governing equation from a free-body diagram,\n- analyze the unforced response and interpret the three damping regimes (underdamped, critically damped, and overdamped), and\n- study the forced response, including resonance, beats, and how damping changes steady-state amplitude and phase.\n\nThroughout, interactive figures and \"Quick Checks\" are used to help you build intuition and check understanding. Hover-to-define terms provide concise definitions inline, and \"Show Work\" sections are available for readers who want more derivation detail.\n\n## Background\n\nThe mass-spring-damper (MSD) system is a simplified mathematical model of many real-world systems. @fig-msd-general-schematic shows the basic system considered. The objective is to find the motion of the mass as a function of time. The mass is connected to the wall via a spring which provides a restoring force when stretched and a resisting force when compressed. This motion is opposed by a {{< ttip text=\"damper\" title=\"A device which dissipates kinetic energy, usually via friction or fluid resistance.\" >}}, which is represented by wall friction in @fig-msd-general-schematic.\n\n::: {.text-center}\n![MSD General Schematic](msd-general-schematic.png){#fig-msd-general-schematic width=80%}\n:::\n\n@fig-msd-moving-schematic shows the MSD system at three different states: when the mass is at rest $t<0$, the motion's initial conditions $t=0$, and once motion begins $t>0$.<br>\nWhen the mass is at rest (in an equilibrium state), the spring is stretched by length $L$. It's convenient to define our coordinate system, $y$, based on position of the mass at its rest state so that displacement represents the distance from equilibrium.<br>\nAt  $t=0$, the mass is displaced by a distance $y_0$ with velocity $v_0$. This causes the mass to move for $t > 0$. Once in motion, we can have either an {{< ttip text=\"unforced system\" title=\"Mass motion is purely due to initial displacement and velocity.\" >}} or a {{< ttip text=\"forced system\" title=\"Mass motion is due to initial conditons plus external forces.\" >}} with the external force $f(t)$.\n\n::: {.text-center}\n![MSD Moving Schematic](msd-moving-schematic.png){#fig-msd-moving-schematic width=80%}\n:::\n\nTo gain an understanding of the real-world applications, we'll now consider four examples of MSD systems (shown in @fig-msd-examples along with a table summary @tbl-msd-examples):\n\n- **Door closer** \\- Opening the door loads a spring in the door closer mechanism, storing energy; when released, the spring drives the door shut while a hydraulic piston forces oil through a small orifice, providing damping that prevents the door from slamming.\n\n- **Bike front suspension** \\- A bump compresses the fork, increasing pressure in the air chamber (spring) that stores energy and pushes the fork back out, while a hydraulic damper controls oil flow to limit how quickly the fork compresses and rebounds so the bike doesn’t bounce.\n\n- **Building** \\- A building sways like a mass-spring-damper in wind or earthquakes, with the structure’s mass moving against the stiffness of columns/walls (spring) and energy lost through material/structural damping (damper). In extreme cases the wind forcing frequency can achieve resonance with the building's natural frequency, which can have catastrophic consequences. Some very tall buildings counter this with a {{< ttip text=\"tuned mass damper (TMD)\" title=\"A type of MSD system which has the same natural frequency as the building but whose motion is out of phase with the building's. Because the motion is out of phase a TMD reduces the oscillation amplitude.\" >}}.\n\n- **RLC circuit** \\- An RLC circuit is the electrical analog of a mass-spring-damper, where inductance acts like mass (inertia), capacitance like a spring (stored energy), and resistance like damping (energy dissipation).\n\n::: {.text-center}\n![MSD Real-World Examples](msd-examples.png){#fig-msd-examples width=100%}\n:::\n\n| Example        | Motion                   | Mass       | Spring          | Damper                    | Force         |\n|----------------|--------------------------|------------|-----------------|---------------------------|---------------|\n| Door Closer    | piston moving            | door       | internal spring | hydraulic damping         | pushing door  |\n| Bike Suspension| vertical motion of bike  | bike frame | coil/air spring | hydraulic damper (oil) | bumpy ground  |\n| Building       | sway                     | building   | stiffness       | structural damping        | wind          |\n| RLC Circuit    | current                  | inductance | elastance (1/C) | resistor                  | applied voltage |\n: MSD real-world examples and their physical analogies {#tbl-msd-examples}\n\n<iframe src=\"q-msd-examples.html\"\n        class=\"quiz-iframe\"\n        style=\"width:100%; border:0;\"\n        loading=\"lazy\"></iframe>\n\n## Governing Equation\n\nTo derive the governing equation for the mass's motion we first need to write the force balance via a free body diagram. @fig-msd-fbd shows the forces acting on the mass. For positive dispacement, $y>0$, the spring is stretched and gives a force in the negative $y$ direction. For negative displacement, the spring is compressed and gives a force in the positive $y$ direction. In both cases the spring force **opposes** the **displacement**, which may be written as $F_s = -ky$ where $k$ is the spring constant. Similarly, the damper **opposes** the **velocity** of the mass. This is just like surface friction opposing the motion of a block sliding or drag slowing a ball thrown through the air. This gives the force, $F_d = -c \\dot{y}$, where a dot overhead represents taking a derivative with time. The linear relationship between force and velocity is an approximation, but accurate for most applications. Finally the external force, $f(t)$, is defined to be positive in the positive $y$ direction.\n\n::: {.text-center}\n![MSD Free Body Diagram](msd-fbd.png){#fig-msd-fbd width=100%}\n:::\n\nNext we apply Newton's second law of motion\n$$\n\\begin{aligned}\n\\sum F_y &= m a = m \\ddot{y} \\\\\n&= f - k y - c \\dot{y}\n\\end{aligned}\n$$\n\nRewriting gives the final governing equation\n$$\nm \\ddot{y} + c \\dot{y} + k y = f\n$$ {#eq-gov-eq}\nThis equation is a second order, linear, nonhomogeneous, ordinary differential equation (ODE) with constant coefficients. Let's define each of these terms.\n\nThe **order** of an ODE is the highest order derivative derivative in the equation. In this case $\\ddot{y}$ is the highest order derivative so we say the ODE is second order.\n\nAn ODE is **linear** if the coefficients of each $y$ term and its derivatives are only functions of the independent variable. e.g. $a(t)\\dot{y}$ is linear but $y\\dot{y}$ is non-linear. A principle feature of linear ODEs is solutions can be {{< ttip text=\"superposed\" title=\"Superposition means that we can obtain further solutions from given ones by adding them or multiplying them with constants. e.g. if y1 and y2 are solutions then so is y = c1*y1 + c2*y2 for any constant value of c1 and c2.\" >}}.\n\nA **homogeneous** ODE is linear but with no external forcing term. The external force, $f(t)$, in @eq-gov-eq makes the equation nonhomogeneous. This distinction has important implications in solution strategies.\n\nAn **ordinary** differential equation only has derivatives with respect to one independent variable; as opposed to a **partial** differential equation which has derivatives with respect to two or more independent variables.\n\nEach of these classifications has a significant influence on solution properties and strategies. Next we'll discuss the unforced system, $f(t) = 0$.\n\n<iframe src=\"q-diff-eq-classification.html\"\n        class=\"quiz-iframe\"\n        style=\"width:100%; border:0;\"\n        loading=\"lazy\"></iframe>\n\n## The Unforced System\n\n### Analytical Solution\n\nIn the unforced system we set $f = 0$ in @eq-gov-eq and get\n$$\nm \\ddot{y} + c \\dot{y} + k y = 0\n$$ {#eq-gov-eq-unforced}\n\nThis equation is now homogeneous, allowing us to apply the superposition principle to obtain the general solution.\n\nIn general, homogeneous ODEs with constant coeffients admit exponential solutions, i.e. solutions of the form $y(t) = a e^{\\lambda t}$ where $\\lambda$ is the growth/decay rate and can be {{< ttip text=\"complex\" title=\"contains real and imaginary parts\" >}}. For example, the first-order ODE $\\dot{y}+by=0$ yields exponential decay $y = a e^{-bt}$ for $b>0$.\n\nThis suggests we should try to solve @eq-gov-eq-unforced assuming $y = a e^{\\lambda t}$. Substituting in @eq-gov-eq-unforced yields\n$$\na m \\lambda^2 e^{\\lambda t} + a c \\lambda e^{\\lambda t} + a k e^{\\lambda t} = (m \\lambda^2 + c \\lambda + k)a e^{\\lambda t} = 0\n$$\nwhich is reduced to\n$$\nm \\lambda^2 + c \\lambda + k = 0.\n$$ {#eq-characteristic-eq}\n@eq-characteristic-eq is known as the **characteristic equation**. This can be solved using the quadratic formula\n$$\n\\lambda_{1,2} = \\frac{1}{2m}\\left( -c \\pm \\sqrt{c^2 - 4 m k} \\right)\n$$ {#eq-characteristic-sol}\nwhere the subcript 1, 2 represents the fact there are two solutions to the characteristic equation corresponding to the \"+\" or \"-\" sign.\n\nWe've now solved the equation! We assumed $y = a e^{\\lambda t}$ and found $\\lambda$ must be @eq-characteristic-sol by solving the characteristic equation. Using the superposition principle, the general solution is then\n$$\ny = a_1 e^{\\lambda_1 t} + a_2 e^{\\lambda_2 t}\n$$ {#eq-msd-unforced-sol}\nThe value of the constants $a_1$ and $a_2$ can be determined by the **initial conditons**, $y(0)=y_0$ and $\\dot{y}(0) = v_0$. Since the ODE is second-order, we need two initial conditions.\n\nNote in @eq-characteristic-sol that if $c^2 < 4mk$ then $\\lambda$ is complex! This has important implications on the solution behavior and will be discussed next.\n\n<!-- <details class=\"deep-dive\">\n  <summary>Deep Dive: Analytical Solution Derivation</summary>\n\n</details> -->\n\n### Undamped\n\nFirst let's consider the undamped case by setting $c=0$. Then @eq-characteristic-sol becomes\n$$\n\\lambda_{1,2} = \\pm \\sqrt{\\frac{k}{m}} i = \\pm \\omega_n i\n$$ {#eq-characteristic-sol-undamped}\nwhere $i \\equiv \\sqrt{-1}$ is the imaginary number and $\\omega_n$ is known as **natural frequency** of the system.\n\nWhat happens when $\\lambda$ is imaginary? Recall Euler's formula $e^{ix} = \\cos x + i \\sin x$. Substituting @eq-characteristic-sol-undamped into @eq-msd-unforced-sol and applying Euler's formula yields\n<details class=\"deep-dive\">\n  <summary>Show Work</summary>\n  \\begin{align*}\n  y &= a_1 e^{i\\omega t} + a_2 e^{-i\\omega t} \\\\\n    &= a_1 \\left( \\cos{\\omega_n t} + i \\sin{\\omega_n t} \\right) + a_2 \\left( \\cos{\\omega_n t} - i \\sin{\\omega_n t} \\right) \\\\\n    &= b_1 \\cos{\\omega_n t} + b_2 \\sin{\\omega_n t}\n  \\end{align*}\n  where the definitions $b_1 \\equiv a_1 + a_2$ and $b_2 \\equiv (a_1 - a_2) i$ are made.\n\n  In order for $b_1$ and $b_2$ to be real numbers, $a_1$ and $a_2$ must be complex conjugates of each other, $a_2 = \\overline{a_1}$.\n\n  The choice of variable names is arbitrary so we return to using $a_1$ and $a_2$ in the final equation.\n</details>\n$$\ny = a_1 \\cos{\\omega_n t} + a_2 \\sin{\\omega_n t}\n$$ {#eq-msd-undamped-sol-constants}\nOnce again we can solve for $a_1$ and $a_2$ given the initial conditions. This gives the final solution.\n$$\ny = y_0 \\cos{\\omega_n t} + \\frac{v_0}{\\omega_n} \\sin{\\omega_n t}\n$$ {#eq-msd-undamped-sol}\n\nNow let's explore the behavior of this solution via the interactive figure below.\n\n<iframe class=\"quiz-iframe\"\n        src=\"interact-msd-undamped.html\"\n        style=\"width:75%; height:1px; border:0; display:block; margin:0 auto; overflow:hidden;\"\n        loading=\"lazy\"\n        scrolling=\"no\"></iframe>\n\n<iframe src=\"qdeck-undamped/qdeck-undamped.html\"\n        class=\"quiz-iframe\"\n        style=\"width:100%; border:0;\"\n        loading=\"lazy\"></iframe>\n\nThrough this demo we've shown that the undamped solution is sinusoidal with frequency $\\omega_n$ which is inherent to the system's properties (mass and spring consant) and **NOT** the initial conditions.\n\nAn undamped system is unrealistic, however. There is always some source of friction or dissipation which decays motion. Next we'll show how damping affects solution behavior.\n\n### Damped\n\nRecall the solution, $\\lambda_{1,2}$, to the characteristic equation, @eq-characteristic-sol. We had hinted that the behavior of the solution depends on the magnitude of $c^2$ versus $4mk$. In other words, the strength of the damping plays critical role in the behavior of the MSD system. \n\nThe analysis is symplified if we introduce a new parameter $\\zeta$ defined to be\n$$\n\\zeta \\equiv \\frac{c}{2m\\omega_n}\n$$\nwhere $\\omega_n \\equiv \\sqrt{k/m}$ is the natural frequency from the undamped case. Using these definitions simplifies the characteristics:\n$$\n\\lambda_{1,2} = \\omega_n \\left( -\\zeta \\pm \\sqrt{\\zeta^2 - 1} \\right).\n$$\nNow it's clear that the solution behavior (real or complex) only depends on the parameter $\\zeta$. Note $\\zeta$ is essentially a non-dimensional damping coefficient.\n\nLet's see how the solution changes now that we've introduced this new parameter.\n\n<iframe class=\"quiz-iframe\"\n        src=\"interact-msd-damped-v3.html\"\n        style=\"width:75%; height:1px; border:0; display:block; margin:0 auto; overflow:hidden;\"\n        loading=\"lazy\"\n        scrolling=\"no\"></iframe>\n\n<iframe src=\"qdeck-damped/qdeck-damped.html\"\n        class=\"quiz-iframe\"\n        style=\"width:100%; border:0;\"\n        loading=\"lazy\"></iframe>\n\nNow that we qualitatively understand the different behavior between under, over, and critically damped systems, let's look into the specifics of each.\n\n#### Underdamped\n\nFor $\\zeta < 1$ the system is underdamped and the solution is oscillatory with an exponentially decaying amplitude. The solution for the underdamped system is\n<details class=\"deep-dive\">\n  <summary>Show Work</summary>\n    For $\\zeta < 1$, $\\lambda_{1,2} = -\\omega_n \\zeta \\pm \\omega_d i$ where $\\omega_d \\equiv \\omega_n \\sqrt{1- \\zeta^2}$. The characteristics are **complex**.\n\n    Substitute $\\lambda$ into the unforced solution and we get\n    \\begin{align*}\n      y &= a_1 e^{(-\\omega_n \\zeta + i \\omega_d) t} + a_2 e^{(-\\omega_n \\zeta - i \\omega_d) t} \\\\\n        &= e^{(-\\omega_n \\zeta)t} \\left( a_1 e^{i \\omega_d t} + a_2 e^{-i \\omega_d t} \\right) \\\\\n        &= e^{(-\\omega_n \\zeta)t} \\left( a_1' \\cos{\\omega_d t} + a_2' \\sin{\\omega_d t} \\right)\n    \\end{align*}\n    where in the last step Euler's formula was used and prime denotes new constants, similar to what was done for the undamped case.\n</details>\n$$\ny = e^{-\\omega_n \\zeta t} \\left( a_1 \\cos \\omega_d t + a_2 \\sin \\omega_d t \\right)\n$$ {#eq-unforced-underdamped-sol}\nwhere\n$$\n\\omega_d = \\omega_n \\sqrt{1-\\zeta^2}\n$$\nis the damped oscillation frequency. For low damping, $\\zeta \\ll 1$, the damped frequency is the same as the natural frequency. However, as damping increases the damped frequency decreases.\n\nThe exponential term $e^{-\\omega_n \\zeta t}$ causes the oscillation amplitude to decay over time. In the demo we showed that this exponential term forms an envelope over the oscillations, representing the maximum amplitude of the oscillations at any time. We also showed that higher natural frequencies decay **faster** than lower natural frequencies.\n\nIn engineering, underdamping may be desired if quick response is desired (reaching $y=0$ fastest) and a little overshoot is okay. This is true for robotic arms where quick motion is essential and controllers can respond overshooting. Overdamping, conversely, can result in delayed response times.\n\n#### Critically Damped\n\nFor $\\zeta = 1$ the system is critically damped and the solution is non-oscillatory with **fast** exponential decay from initial conditions. This has the solution\n<details class=\"deep-dive\">\n  <summary>Show Work</summary>\n    For $\\zeta = 1$, $\\lambda = -\\omega_n \\zeta$. This corresponds with a double root of the characteristic equation. This means that we no longer have two linearly independent solutions and we have to find a new independent solution. This involves the **reduction of order** method which is beyond the scope of this lesson. For now, let's assume it has the form $y_2 = a_2 te^{\\lambda t}$. Then using $y_1 = a_1 e^{\\lambda t}$ we get\n    $$\n      y = y_1 + y_2 = (a_1 + a_2 t)e^{-\\omega_n \\zeta t}\n    $$\n</details>\n$$\ny = (a_1 + a_2 t) e^{-\\omega_n t}.\n$$\n\nThis solution corresponds with the least amount of time to reach {{< ttip text=\"stationary\" title=\"displacement AND velocity are zero\" >}} conditions. The solution can cross $y=0$ at most one time when $a_1 + a_2 t = 0$.\n\nA critically damped system is desired if you want motion damped quickly without oscillation.\nThis is true for door closers. If underdamped, the door slams shut or oscillates. If overdamped, the door takes too long to close.\n\n#### Overdamped\n\nFor $\\zeta > 1$ the solution is **overdamped** and is non-oscillatory with **slow** exponential decay from initial conditions. This has the solution\n<details class=\"deep-dive\">\n  <summary>Show Work</summary>\n    For $\\zeta > 1$, $\\lambda_{1,2} = -\\omega_n \\left( \\zeta \\pm \\sqrt{\\zeta^2-1} \\right)$ corresponding to two **real** characteristics. Substituting into the general solution gives\n    $$\n      y = a_1 e^{-\\omega_n t \\left( \\zeta + \\sqrt{\\zeta^2-1}\\right)} + a_2 e^{-\\omega_n t \\left( \\zeta - \\sqrt{\\zeta^2-1} \\right)}\n    $$\n</details>\n$$\ny = a_1 e^{-\\omega_n t \\left( \\zeta + \\sqrt{\\zeta^2-1}\\right)} + a_2 e^{-\\omega_n t \\left( \\zeta - \\sqrt{\\zeta^2-1} \\right)}\n$$\n\nThis has two decay rates: one fast and one slow with the slow rate dominating over long times and both interacting for short times.\n\nIn some cases, overdamping is desired. Industrial {{< ttip text=\"shock absorbers\" title=\"hydraulic dampers that dissipate kinetic energy as heat to control impacts\" >}} (end-of-stroke dampers) are commonly selected or adjusted so the overall response is near-critically damped or slightly overdamped, bringing a moving load to rest without oscillation or rebound. An underdamped (oscillatory) response can cause repeated impacts that damage nearby components or fixtures, so minimizing bounce is often the safer design choice.\n\nNext we'll discuss the forced system, when $f(t) \\neq 0$.\n\n## The Forced System\n\n### Undamped\n\nPreviously we've only dealt with **homogeneous** ODEs. Now we have a **nonhomogeneous** ODE when  $f(t) \\neq 0$. For **linear** nonhomogeneous ODEs we can get the general solution by adding a particular solution to the homogeneous solution. That is\n$$\ny(t) = y_h(t) + y_p(t)\n$$ {#eq-nonhomogeneous-gen-sol}\nwhere $y_h = a_1 y_1 + a_2 y_2$ is the **homogeneous** solution to @eq-gov-eq-unforced with arbitrary constants, $a_1$ and $a_2$, (discussed previously in the unforced section) and $y_p$ is a **particular** solution to @eq-gov-eq with no arbitrary constants.\n\nGeneral methods for finding the particular solution are difficult and beyond the scope of this lesson. Instead we'll only consider forcing of the form\n$$\nf(t) = f_0 \\cos \\omega_f t.\n$$\nwhich has many real-world implications. We've now introduced a new important parameter, $\\omega_f$, the forcing frequency. The forcing frequency interacts with the natural frequency of the system in interesting ways. \n\nTo understand this interaction between the forcing and natural frequency, let's first consider the **undamped** system ($c=0$) with periodic forcing and its solution. The governing equation is\n$$\nm \\ddot{y} + k y = f_0 \\cos \\omega_f t\n$$ {#eq-gov-eq-forced-undamped}\nand the corresponding homogeneous solution was found previously, @eq-msd-undamped-sol-constants. The particular solution is found using the **method of undetermined coefficients**. This method can only be applied if the force, $f(t)$, has specific functional forms. If it meets this criteria then the particular solution will be a known functional form with undetermined coefficients. For a sine or cosine function with frequency $\\omega_f$, the particular solution is\n$$\ny_p = b_1 \\cos{\\omega_f t} + b_2 \\sin{\\omega_f t}.\n$$ {#eq-particular-solution}\nThe undetermined coefficients, $b_1$ and $b_2$, are found by substituting the particular solution into @eq-gov-eq-forced-undamped. This leads to a system of equations for the coefficients which is solved to yield\n$$\nb_1 = \\frac{f_0}{m\\left( \\omega_n^2 - \\omega_f^2 \\right)}, \\quad b_2 = 0.\n$$\nThen we superpose the homogeneous and particular solutions to get the general solution\n$$\ny(t) = a_1 \\cos{\\omega_n t} + a_2 \\sin{\\omega_n t} + \\frac{f_0}{m\\left( \\omega_n^2 - \\omega_f^2 \\right)} \\cos{\\omega_f t}\n$$ {#eq-forced-undamped-sol}\nwhere\n$$\na_1 = y_0 - \\frac{f_0}{m\\left( \\omega_n^2 - \\omega_f^2 \\right)}, \\quad a_2 = \\frac{v_0}{\\omega_n}\n$$\nwere found using the initial conditions. Note the coefficients go to infinity when $\\omega_f = \\omega_n$. In this situation we must assume a different form for the particular solution because $y_p$, @eq-particular-solution, is not {{< ttip text=\"linearly independent\" title=\"y1(x) and y2(x) are linearly independent if and only if the only way c1*y1 + c2*y2 = 0 (for all x) is with c1 = c2 = 0\" >}} from $y_h$, @eq-msd-undamped-sol-constants, when $\\omega_f = \\omega_n$. Instead we must choose a trial function\n$$\ny_p = b_1 t \\cos{\\omega_f t} + b_2 t \\sin{\\omega_f t}.\n$$\nThen we can repeat the process and get the general solution when the forcing and natural frequencies match:\n$$\ny(t) = a_1 \\cos{\\omega_n t} + a_2 \\sin{\\omega_n t} + \\frac{f_0}{2m\\omega_n} t \\sin{\\omega_n t}.\n$$ {#eq-forced-undamped-resonance-sol}\n\nBelow is a demo to explore the behavior of the undamped solution. The solid line corresponds with the undamped solution (@eq-forced-undamped-sol and @eq-forced-undamped-resonance-sol) and the dashed line corresponds with the {{< ttip text=\"envelope\" title=\"amplitude variations over time\" >}} of this solution.\n\n<iframe class=\"quiz-iframe\"\n        src=\"interact-msd-resonance-undamped.html\"\n        style=\"width:75%; height:1px; border:0; display:block; margin:0 auto; overflow:hidden;\"\n        loading=\"lazy\"\n        scrolling=\"no\"></iframe>\n\n<iframe src=\"qdeck-resonance/qdeck-resonance.html\"\n        class=\"quiz-iframe\"\n        style=\"width:100%; border:0;\"\n        loading=\"lazy\"></iframe>\n\nThis demo demonstrated the concepts of **resonance** and **beats**.\n\n**Resonance** occurs when the forcing frequency matches the natural frequency of the system. This results in amplification of the motion over time. This is similar to swinging. To increase your height, you propel yourself forward at the same time the swing starts to move forward. In other words, your forcing frequency is aligned with the swinging frequency. Resonance is also why singing at the right pitch (forcing frequency) can cause a glass (natural frequency) to break. In some cases resonance be catastrophic. For tall buildings (or other large civil structures), wind can generate a forcing frequency which resonates with the building, capable of causing damage if oscillation amplitudes are large enough. In engines or other periodic forcing machines it's important to make sure none of the other components have the same natural frequency as the forcing, otherwise vibrations could be amplified.\n\n**Beats** occur when the forcing frequency is close to the natural frequency. Because the forcing frequency and natural frequency of the system are slightly different, forces slowly go from in phase (amplification) to out of phase (cancelation), generating low frequency beats. Guitar tuning utilizes this feature. When you tune a guitar, you listen for beats (slow pulsing) that happens when the string and a reference note are slightly different in frequency. As you tune closer, the beat rate slows, and when the beats nearly disappear the pitches match.\n\n### Damped\n\nZero damping is unrealistic. Real systems have some amount of damping. In this section we'll introduce damping to the forced system and how it affects resonance.\n\nWith damping we will be solving\n$$\nm \\ddot{y} + c\\dot{y} + k y = f_0 \\cos \\omega_f t\n$$ {#eq-gov-eq-forced-undamped}\nand again the solution has homogeneous and particular parts. The particular solution is the same as the undamped case, @eq-particular-solution. The homogeneous solution is the same as the unforced underdamped solution, @eq-unforced-underdamped-sol. \n\nWe repeat the process as was done in the undamped case and get the general solution\n$$\ny(t) = y_h(t) + y_p(t)\n$$\nwhere\n$$\ny_h = e^{-\\omega_n \\zeta t} \\left( a_1 \\cos \\omega_d t + a_2 \\sin \\omega_d t \\right),\n$$\nwith $a_1$ and $a_2$ determined from initial conditions and\n$$\ny_p = b_1 \\cos{\\omega_f t} + b_2 \\sin{\\omega_f t}\n$$\nwith the coefficients\n$$\nb_1 = \\frac{(f_0/k)(1-r^2)}{(1-r^2)^2 + (2\\zeta r)^2}, \\quad b_2 = \\frac{(f_0/k)(2\\zeta r)}{(1-r^2)^2 + (2\\zeta r)^2}\n$$\nand $r=\\omega_f/\\omega_n$ is the frequency ratio.\n\nNote now $y_h$ decays to zero as $t\\to \\infty$ as opposed to the undamped case where $y_h$ is an undecaying sinusoid. This means that for long times (on the order $t>3\\zeta \\omega_n$) after the initial motion the particular solution will dominate. Therefore, when considering damped resonance it is useful to only consider the particular solution and its maximum amplitude. This is often called **practical resonance**.\n\nWe can understand practical resonance by rewriting the particular solution (using trigonometric identities) as\n$$\ny_p = A \\cos (\\omega_f t - \\phi)\n$$\nwhere $A$ is the **amplitude** of $y_p$ and $\\phi$ is the **phase angle** or **phase lag** because it measures the lag of the output behind the input. These are evaluated as\n$$\nA = \\sqrt{b_1^2 + b_2^2} = \\frac{f_0/m}{\\sqrt{(1-r^2)^2 + (2\\zeta r)^2}}, \\quad \\tan \\phi = \\frac{b_2}{b_1} = \\frac{2\\zeta r}{1-r^2}.\n$$\n\nLet's now see how the response amplitude and phase are influenced by damping and forcing frequency via an interactive demo. The figure on the left plots amplitude versus the frequency ration $\\omega_f/\\omega_n$. The response amplitude is normalized by the steady forcing displacement ($f_0/k$) and so a value greater than one corresponds with amplification relative to the input. \n\n<iframe class=\"quiz-iframe\"\n        src=\"interact-msd-resonance-damped-amplitude-phase.html\"\n        style=\"width:100%; height:1px; border:0; display:block; margin:0 auto; overflow:hidden;\"\n        loading=\"lazy\"\n        scrolling=\"no\"></iframe>\n\n<iframe src=\"qdeck-resonance-damped/qdeck-resonance-damped.html\"\n        class=\"quiz-iframe\"\n        style=\"width:100%; border:0;\"\n        loading=\"lazy\"></iframe>\n\n<!-- As $\\zeta$ increases, what happens to the height of the resonance peak?\nAs $\\zeta$ increases, what happens to the width of the resonance peak?\nWhat value of $\\zeta$ is there no longer a resonance peak? answer = 0.707\nWhat is the phase lag for $r\\ll 1$?\n- quasi-steady: $ky = f$\nWhat is the phase lag for $r=1$?\n- 90 degrees because the force is aligned with velocity/damping, making energy transfer most effective\n- $cy' = f$ \nWhat is the phase lag for $r>>1$?\n- inertia dominated $my'' = f$ -->","srcMarkdownNoYaml":"\n\n## Lesson Scope\n\nThis lesson supplements an undergraduate course in differential equations by using the mass-spring-damper (MSD) model to connect second-order linear ODEs to engineering vibration problems.\n\nYou will:\n\n- connect common engineering examples to the MSD model,\n- derive the governing equation from a free-body diagram,\n- analyze the unforced response and interpret the three damping regimes (underdamped, critically damped, and overdamped), and\n- study the forced response, including resonance, beats, and how damping changes steady-state amplitude and phase.\n\nThroughout, interactive figures and \"Quick Checks\" are used to help you build intuition and check understanding. Hover-to-define terms provide concise definitions inline, and \"Show Work\" sections are available for readers who want more derivation detail.\n\n## Background\n\nThe mass-spring-damper (MSD) system is a simplified mathematical model of many real-world systems. @fig-msd-general-schematic shows the basic system considered. The objective is to find the motion of the mass as a function of time. The mass is connected to the wall via a spring which provides a restoring force when stretched and a resisting force when compressed. This motion is opposed by a {{< ttip text=\"damper\" title=\"A device which dissipates kinetic energy, usually via friction or fluid resistance.\" >}}, which is represented by wall friction in @fig-msd-general-schematic.\n\n::: {.text-center}\n![MSD General Schematic](msd-general-schematic.png){#fig-msd-general-schematic width=80%}\n:::\n\n@fig-msd-moving-schematic shows the MSD system at three different states: when the mass is at rest $t<0$, the motion's initial conditions $t=0$, and once motion begins $t>0$.<br>\nWhen the mass is at rest (in an equilibrium state), the spring is stretched by length $L$. It's convenient to define our coordinate system, $y$, based on position of the mass at its rest state so that displacement represents the distance from equilibrium.<br>\nAt  $t=0$, the mass is displaced by a distance $y_0$ with velocity $v_0$. This causes the mass to move for $t > 0$. Once in motion, we can have either an {{< ttip text=\"unforced system\" title=\"Mass motion is purely due to initial displacement and velocity.\" >}} or a {{< ttip text=\"forced system\" title=\"Mass motion is due to initial conditons plus external forces.\" >}} with the external force $f(t)$.\n\n::: {.text-center}\n![MSD Moving Schematic](msd-moving-schematic.png){#fig-msd-moving-schematic width=80%}\n:::\n\nTo gain an understanding of the real-world applications, we'll now consider four examples of MSD systems (shown in @fig-msd-examples along with a table summary @tbl-msd-examples):\n\n- **Door closer** \\- Opening the door loads a spring in the door closer mechanism, storing energy; when released, the spring drives the door shut while a hydraulic piston forces oil through a small orifice, providing damping that prevents the door from slamming.\n\n- **Bike front suspension** \\- A bump compresses the fork, increasing pressure in the air chamber (spring) that stores energy and pushes the fork back out, while a hydraulic damper controls oil flow to limit how quickly the fork compresses and rebounds so the bike doesn’t bounce.\n\n- **Building** \\- A building sways like a mass-spring-damper in wind or earthquakes, with the structure’s mass moving against the stiffness of columns/walls (spring) and energy lost through material/structural damping (damper). In extreme cases the wind forcing frequency can achieve resonance with the building's natural frequency, which can have catastrophic consequences. Some very tall buildings counter this with a {{< ttip text=\"tuned mass damper (TMD)\" title=\"A type of MSD system which has the same natural frequency as the building but whose motion is out of phase with the building's. Because the motion is out of phase a TMD reduces the oscillation amplitude.\" >}}.\n\n- **RLC circuit** \\- An RLC circuit is the electrical analog of a mass-spring-damper, where inductance acts like mass (inertia), capacitance like a spring (stored energy), and resistance like damping (energy dissipation).\n\n::: {.text-center}\n![MSD Real-World Examples](msd-examples.png){#fig-msd-examples width=100%}\n:::\n\n| Example        | Motion                   | Mass       | Spring          | Damper                    | Force         |\n|----------------|--------------------------|------------|-----------------|---------------------------|---------------|\n| Door Closer    | piston moving            | door       | internal spring | hydraulic damping         | pushing door  |\n| Bike Suspension| vertical motion of bike  | bike frame | coil/air spring | hydraulic damper (oil) | bumpy ground  |\n| Building       | sway                     | building   | stiffness       | structural damping        | wind          |\n| RLC Circuit    | current                  | inductance | elastance (1/C) | resistor                  | applied voltage |\n: MSD real-world examples and their physical analogies {#tbl-msd-examples}\n\n<iframe src=\"q-msd-examples.html\"\n        class=\"quiz-iframe\"\n        style=\"width:100%; border:0;\"\n        loading=\"lazy\"></iframe>\n\n## Governing Equation\n\nTo derive the governing equation for the mass's motion we first need to write the force balance via a free body diagram. @fig-msd-fbd shows the forces acting on the mass. For positive dispacement, $y>0$, the spring is stretched and gives a force in the negative $y$ direction. For negative displacement, the spring is compressed and gives a force in the positive $y$ direction. In both cases the spring force **opposes** the **displacement**, which may be written as $F_s = -ky$ where $k$ is the spring constant. Similarly, the damper **opposes** the **velocity** of the mass. This is just like surface friction opposing the motion of a block sliding or drag slowing a ball thrown through the air. This gives the force, $F_d = -c \\dot{y}$, where a dot overhead represents taking a derivative with time. The linear relationship between force and velocity is an approximation, but accurate for most applications. Finally the external force, $f(t)$, is defined to be positive in the positive $y$ direction.\n\n::: {.text-center}\n![MSD Free Body Diagram](msd-fbd.png){#fig-msd-fbd width=100%}\n:::\n\nNext we apply Newton's second law of motion\n$$\n\\begin{aligned}\n\\sum F_y &= m a = m \\ddot{y} \\\\\n&= f - k y - c \\dot{y}\n\\end{aligned}\n$$\n\nRewriting gives the final governing equation\n$$\nm \\ddot{y} + c \\dot{y} + k y = f\n$$ {#eq-gov-eq}\nThis equation is a second order, linear, nonhomogeneous, ordinary differential equation (ODE) with constant coefficients. Let's define each of these terms.\n\nThe **order** of an ODE is the highest order derivative derivative in the equation. In this case $\\ddot{y}$ is the highest order derivative so we say the ODE is second order.\n\nAn ODE is **linear** if the coefficients of each $y$ term and its derivatives are only functions of the independent variable. e.g. $a(t)\\dot{y}$ is linear but $y\\dot{y}$ is non-linear. A principle feature of linear ODEs is solutions can be {{< ttip text=\"superposed\" title=\"Superposition means that we can obtain further solutions from given ones by adding them or multiplying them with constants. e.g. if y1 and y2 are solutions then so is y = c1*y1 + c2*y2 for any constant value of c1 and c2.\" >}}.\n\nA **homogeneous** ODE is linear but with no external forcing term. The external force, $f(t)$, in @eq-gov-eq makes the equation nonhomogeneous. This distinction has important implications in solution strategies.\n\nAn **ordinary** differential equation only has derivatives with respect to one independent variable; as opposed to a **partial** differential equation which has derivatives with respect to two or more independent variables.\n\nEach of these classifications has a significant influence on solution properties and strategies. Next we'll discuss the unforced system, $f(t) = 0$.\n\n<iframe src=\"q-diff-eq-classification.html\"\n        class=\"quiz-iframe\"\n        style=\"width:100%; border:0;\"\n        loading=\"lazy\"></iframe>\n\n## The Unforced System\n\n### Analytical Solution\n\nIn the unforced system we set $f = 0$ in @eq-gov-eq and get\n$$\nm \\ddot{y} + c \\dot{y} + k y = 0\n$$ {#eq-gov-eq-unforced}\n\nThis equation is now homogeneous, allowing us to apply the superposition principle to obtain the general solution.\n\nIn general, homogeneous ODEs with constant coeffients admit exponential solutions, i.e. solutions of the form $y(t) = a e^{\\lambda t}$ where $\\lambda$ is the growth/decay rate and can be {{< ttip text=\"complex\" title=\"contains real and imaginary parts\" >}}. For example, the first-order ODE $\\dot{y}+by=0$ yields exponential decay $y = a e^{-bt}$ for $b>0$.\n\nThis suggests we should try to solve @eq-gov-eq-unforced assuming $y = a e^{\\lambda t}$. Substituting in @eq-gov-eq-unforced yields\n$$\na m \\lambda^2 e^{\\lambda t} + a c \\lambda e^{\\lambda t} + a k e^{\\lambda t} = (m \\lambda^2 + c \\lambda + k)a e^{\\lambda t} = 0\n$$\nwhich is reduced to\n$$\nm \\lambda^2 + c \\lambda + k = 0.\n$$ {#eq-characteristic-eq}\n@eq-characteristic-eq is known as the **characteristic equation**. This can be solved using the quadratic formula\n$$\n\\lambda_{1,2} = \\frac{1}{2m}\\left( -c \\pm \\sqrt{c^2 - 4 m k} \\right)\n$$ {#eq-characteristic-sol}\nwhere the subcript 1, 2 represents the fact there are two solutions to the characteristic equation corresponding to the \"+\" or \"-\" sign.\n\nWe've now solved the equation! We assumed $y = a e^{\\lambda t}$ and found $\\lambda$ must be @eq-characteristic-sol by solving the characteristic equation. Using the superposition principle, the general solution is then\n$$\ny = a_1 e^{\\lambda_1 t} + a_2 e^{\\lambda_2 t}\n$$ {#eq-msd-unforced-sol}\nThe value of the constants $a_1$ and $a_2$ can be determined by the **initial conditons**, $y(0)=y_0$ and $\\dot{y}(0) = v_0$. Since the ODE is second-order, we need two initial conditions.\n\nNote in @eq-characteristic-sol that if $c^2 < 4mk$ then $\\lambda$ is complex! This has important implications on the solution behavior and will be discussed next.\n\n<!-- <details class=\"deep-dive\">\n  <summary>Deep Dive: Analytical Solution Derivation</summary>\n\n</details> -->\n\n### Undamped\n\nFirst let's consider the undamped case by setting $c=0$. Then @eq-characteristic-sol becomes\n$$\n\\lambda_{1,2} = \\pm \\sqrt{\\frac{k}{m}} i = \\pm \\omega_n i\n$$ {#eq-characteristic-sol-undamped}\nwhere $i \\equiv \\sqrt{-1}$ is the imaginary number and $\\omega_n$ is known as **natural frequency** of the system.\n\nWhat happens when $\\lambda$ is imaginary? Recall Euler's formula $e^{ix} = \\cos x + i \\sin x$. Substituting @eq-characteristic-sol-undamped into @eq-msd-unforced-sol and applying Euler's formula yields\n<details class=\"deep-dive\">\n  <summary>Show Work</summary>\n  \\begin{align*}\n  y &= a_1 e^{i\\omega t} + a_2 e^{-i\\omega t} \\\\\n    &= a_1 \\left( \\cos{\\omega_n t} + i \\sin{\\omega_n t} \\right) + a_2 \\left( \\cos{\\omega_n t} - i \\sin{\\omega_n t} \\right) \\\\\n    &= b_1 \\cos{\\omega_n t} + b_2 \\sin{\\omega_n t}\n  \\end{align*}\n  where the definitions $b_1 \\equiv a_1 + a_2$ and $b_2 \\equiv (a_1 - a_2) i$ are made.\n\n  In order for $b_1$ and $b_2$ to be real numbers, $a_1$ and $a_2$ must be complex conjugates of each other, $a_2 = \\overline{a_1}$.\n\n  The choice of variable names is arbitrary so we return to using $a_1$ and $a_2$ in the final equation.\n</details>\n$$\ny = a_1 \\cos{\\omega_n t} + a_2 \\sin{\\omega_n t}\n$$ {#eq-msd-undamped-sol-constants}\nOnce again we can solve for $a_1$ and $a_2$ given the initial conditions. This gives the final solution.\n$$\ny = y_0 \\cos{\\omega_n t} + \\frac{v_0}{\\omega_n} \\sin{\\omega_n t}\n$$ {#eq-msd-undamped-sol}\n\nNow let's explore the behavior of this solution via the interactive figure below.\n\n<iframe class=\"quiz-iframe\"\n        src=\"interact-msd-undamped.html\"\n        style=\"width:75%; height:1px; border:0; display:block; margin:0 auto; overflow:hidden;\"\n        loading=\"lazy\"\n        scrolling=\"no\"></iframe>\n\n<iframe src=\"qdeck-undamped/qdeck-undamped.html\"\n        class=\"quiz-iframe\"\n        style=\"width:100%; border:0;\"\n        loading=\"lazy\"></iframe>\n\nThrough this demo we've shown that the undamped solution is sinusoidal with frequency $\\omega_n$ which is inherent to the system's properties (mass and spring consant) and **NOT** the initial conditions.\n\nAn undamped system is unrealistic, however. There is always some source of friction or dissipation which decays motion. Next we'll show how damping affects solution behavior.\n\n### Damped\n\nRecall the solution, $\\lambda_{1,2}$, to the characteristic equation, @eq-characteristic-sol. We had hinted that the behavior of the solution depends on the magnitude of $c^2$ versus $4mk$. In other words, the strength of the damping plays critical role in the behavior of the MSD system. \n\nThe analysis is symplified if we introduce a new parameter $\\zeta$ defined to be\n$$\n\\zeta \\equiv \\frac{c}{2m\\omega_n}\n$$\nwhere $\\omega_n \\equiv \\sqrt{k/m}$ is the natural frequency from the undamped case. Using these definitions simplifies the characteristics:\n$$\n\\lambda_{1,2} = \\omega_n \\left( -\\zeta \\pm \\sqrt{\\zeta^2 - 1} \\right).\n$$\nNow it's clear that the solution behavior (real or complex) only depends on the parameter $\\zeta$. Note $\\zeta$ is essentially a non-dimensional damping coefficient.\n\nLet's see how the solution changes now that we've introduced this new parameter.\n\n<iframe class=\"quiz-iframe\"\n        src=\"interact-msd-damped-v3.html\"\n        style=\"width:75%; height:1px; border:0; display:block; margin:0 auto; overflow:hidden;\"\n        loading=\"lazy\"\n        scrolling=\"no\"></iframe>\n\n<iframe src=\"qdeck-damped/qdeck-damped.html\"\n        class=\"quiz-iframe\"\n        style=\"width:100%; border:0;\"\n        loading=\"lazy\"></iframe>\n\nNow that we qualitatively understand the different behavior between under, over, and critically damped systems, let's look into the specifics of each.\n\n#### Underdamped\n\nFor $\\zeta < 1$ the system is underdamped and the solution is oscillatory with an exponentially decaying amplitude. The solution for the underdamped system is\n<details class=\"deep-dive\">\n  <summary>Show Work</summary>\n    For $\\zeta < 1$, $\\lambda_{1,2} = -\\omega_n \\zeta \\pm \\omega_d i$ where $\\omega_d \\equiv \\omega_n \\sqrt{1- \\zeta^2}$. The characteristics are **complex**.\n\n    Substitute $\\lambda$ into the unforced solution and we get\n    \\begin{align*}\n      y &= a_1 e^{(-\\omega_n \\zeta + i \\omega_d) t} + a_2 e^{(-\\omega_n \\zeta - i \\omega_d) t} \\\\\n        &= e^{(-\\omega_n \\zeta)t} \\left( a_1 e^{i \\omega_d t} + a_2 e^{-i \\omega_d t} \\right) \\\\\n        &= e^{(-\\omega_n \\zeta)t} \\left( a_1' \\cos{\\omega_d t} + a_2' \\sin{\\omega_d t} \\right)\n    \\end{align*}\n    where in the last step Euler's formula was used and prime denotes new constants, similar to what was done for the undamped case.\n</details>\n$$\ny = e^{-\\omega_n \\zeta t} \\left( a_1 \\cos \\omega_d t + a_2 \\sin \\omega_d t \\right)\n$$ {#eq-unforced-underdamped-sol}\nwhere\n$$\n\\omega_d = \\omega_n \\sqrt{1-\\zeta^2}\n$$\nis the damped oscillation frequency. For low damping, $\\zeta \\ll 1$, the damped frequency is the same as the natural frequency. However, as damping increases the damped frequency decreases.\n\nThe exponential term $e^{-\\omega_n \\zeta t}$ causes the oscillation amplitude to decay over time. In the demo we showed that this exponential term forms an envelope over the oscillations, representing the maximum amplitude of the oscillations at any time. We also showed that higher natural frequencies decay **faster** than lower natural frequencies.\n\nIn engineering, underdamping may be desired if quick response is desired (reaching $y=0$ fastest) and a little overshoot is okay. This is true for robotic arms where quick motion is essential and controllers can respond overshooting. Overdamping, conversely, can result in delayed response times.\n\n#### Critically Damped\n\nFor $\\zeta = 1$ the system is critically damped and the solution is non-oscillatory with **fast** exponential decay from initial conditions. This has the solution\n<details class=\"deep-dive\">\n  <summary>Show Work</summary>\n    For $\\zeta = 1$, $\\lambda = -\\omega_n \\zeta$. This corresponds with a double root of the characteristic equation. This means that we no longer have two linearly independent solutions and we have to find a new independent solution. This involves the **reduction of order** method which is beyond the scope of this lesson. For now, let's assume it has the form $y_2 = a_2 te^{\\lambda t}$. Then using $y_1 = a_1 e^{\\lambda t}$ we get\n    $$\n      y = y_1 + y_2 = (a_1 + a_2 t)e^{-\\omega_n \\zeta t}\n    $$\n</details>\n$$\ny = (a_1 + a_2 t) e^{-\\omega_n t}.\n$$\n\nThis solution corresponds with the least amount of time to reach {{< ttip text=\"stationary\" title=\"displacement AND velocity are zero\" >}} conditions. The solution can cross $y=0$ at most one time when $a_1 + a_2 t = 0$.\n\nA critically damped system is desired if you want motion damped quickly without oscillation.\nThis is true for door closers. If underdamped, the door slams shut or oscillates. If overdamped, the door takes too long to close.\n\n#### Overdamped\n\nFor $\\zeta > 1$ the solution is **overdamped** and is non-oscillatory with **slow** exponential decay from initial conditions. This has the solution\n<details class=\"deep-dive\">\n  <summary>Show Work</summary>\n    For $\\zeta > 1$, $\\lambda_{1,2} = -\\omega_n \\left( \\zeta \\pm \\sqrt{\\zeta^2-1} \\right)$ corresponding to two **real** characteristics. Substituting into the general solution gives\n    $$\n      y = a_1 e^{-\\omega_n t \\left( \\zeta + \\sqrt{\\zeta^2-1}\\right)} + a_2 e^{-\\omega_n t \\left( \\zeta - \\sqrt{\\zeta^2-1} \\right)}\n    $$\n</details>\n$$\ny = a_1 e^{-\\omega_n t \\left( \\zeta + \\sqrt{\\zeta^2-1}\\right)} + a_2 e^{-\\omega_n t \\left( \\zeta - \\sqrt{\\zeta^2-1} \\right)}\n$$\n\nThis has two decay rates: one fast and one slow with the slow rate dominating over long times and both interacting for short times.\n\nIn some cases, overdamping is desired. Industrial {{< ttip text=\"shock absorbers\" title=\"hydraulic dampers that dissipate kinetic energy as heat to control impacts\" >}} (end-of-stroke dampers) are commonly selected or adjusted so the overall response is near-critically damped or slightly overdamped, bringing a moving load to rest without oscillation or rebound. An underdamped (oscillatory) response can cause repeated impacts that damage nearby components or fixtures, so minimizing bounce is often the safer design choice.\n\nNext we'll discuss the forced system, when $f(t) \\neq 0$.\n\n## The Forced System\n\n### Undamped\n\nPreviously we've only dealt with **homogeneous** ODEs. Now we have a **nonhomogeneous** ODE when  $f(t) \\neq 0$. For **linear** nonhomogeneous ODEs we can get the general solution by adding a particular solution to the homogeneous solution. That is\n$$\ny(t) = y_h(t) + y_p(t)\n$$ {#eq-nonhomogeneous-gen-sol}\nwhere $y_h = a_1 y_1 + a_2 y_2$ is the **homogeneous** solution to @eq-gov-eq-unforced with arbitrary constants, $a_1$ and $a_2$, (discussed previously in the unforced section) and $y_p$ is a **particular** solution to @eq-gov-eq with no arbitrary constants.\n\nGeneral methods for finding the particular solution are difficult and beyond the scope of this lesson. Instead we'll only consider forcing of the form\n$$\nf(t) = f_0 \\cos \\omega_f t.\n$$\nwhich has many real-world implications. We've now introduced a new important parameter, $\\omega_f$, the forcing frequency. The forcing frequency interacts with the natural frequency of the system in interesting ways. \n\nTo understand this interaction between the forcing and natural frequency, let's first consider the **undamped** system ($c=0$) with periodic forcing and its solution. The governing equation is\n$$\nm \\ddot{y} + k y = f_0 \\cos \\omega_f t\n$$ {#eq-gov-eq-forced-undamped}\nand the corresponding homogeneous solution was found previously, @eq-msd-undamped-sol-constants. The particular solution is found using the **method of undetermined coefficients**. This method can only be applied if the force, $f(t)$, has specific functional forms. If it meets this criteria then the particular solution will be a known functional form with undetermined coefficients. For a sine or cosine function with frequency $\\omega_f$, the particular solution is\n$$\ny_p = b_1 \\cos{\\omega_f t} + b_2 \\sin{\\omega_f t}.\n$$ {#eq-particular-solution}\nThe undetermined coefficients, $b_1$ and $b_2$, are found by substituting the particular solution into @eq-gov-eq-forced-undamped. This leads to a system of equations for the coefficients which is solved to yield\n$$\nb_1 = \\frac{f_0}{m\\left( \\omega_n^2 - \\omega_f^2 \\right)}, \\quad b_2 = 0.\n$$\nThen we superpose the homogeneous and particular solutions to get the general solution\n$$\ny(t) = a_1 \\cos{\\omega_n t} + a_2 \\sin{\\omega_n t} + \\frac{f_0}{m\\left( \\omega_n^2 - \\omega_f^2 \\right)} \\cos{\\omega_f t}\n$$ {#eq-forced-undamped-sol}\nwhere\n$$\na_1 = y_0 - \\frac{f_0}{m\\left( \\omega_n^2 - \\omega_f^2 \\right)}, \\quad a_2 = \\frac{v_0}{\\omega_n}\n$$\nwere found using the initial conditions. Note the coefficients go to infinity when $\\omega_f = \\omega_n$. In this situation we must assume a different form for the particular solution because $y_p$, @eq-particular-solution, is not {{< ttip text=\"linearly independent\" title=\"y1(x) and y2(x) are linearly independent if and only if the only way c1*y1 + c2*y2 = 0 (for all x) is with c1 = c2 = 0\" >}} from $y_h$, @eq-msd-undamped-sol-constants, when $\\omega_f = \\omega_n$. Instead we must choose a trial function\n$$\ny_p = b_1 t \\cos{\\omega_f t} + b_2 t \\sin{\\omega_f t}.\n$$\nThen we can repeat the process and get the general solution when the forcing and natural frequencies match:\n$$\ny(t) = a_1 \\cos{\\omega_n t} + a_2 \\sin{\\omega_n t} + \\frac{f_0}{2m\\omega_n} t \\sin{\\omega_n t}.\n$$ {#eq-forced-undamped-resonance-sol}\n\nBelow is a demo to explore the behavior of the undamped solution. The solid line corresponds with the undamped solution (@eq-forced-undamped-sol and @eq-forced-undamped-resonance-sol) and the dashed line corresponds with the {{< ttip text=\"envelope\" title=\"amplitude variations over time\" >}} of this solution.\n\n<iframe class=\"quiz-iframe\"\n        src=\"interact-msd-resonance-undamped.html\"\n        style=\"width:75%; height:1px; border:0; display:block; margin:0 auto; overflow:hidden;\"\n        loading=\"lazy\"\n        scrolling=\"no\"></iframe>\n\n<iframe src=\"qdeck-resonance/qdeck-resonance.html\"\n        class=\"quiz-iframe\"\n        style=\"width:100%; border:0;\"\n        loading=\"lazy\"></iframe>\n\nThis demo demonstrated the concepts of **resonance** and **beats**.\n\n**Resonance** occurs when the forcing frequency matches the natural frequency of the system. This results in amplification of the motion over time. This is similar to swinging. To increase your height, you propel yourself forward at the same time the swing starts to move forward. In other words, your forcing frequency is aligned with the swinging frequency. Resonance is also why singing at the right pitch (forcing frequency) can cause a glass (natural frequency) to break. In some cases resonance be catastrophic. For tall buildings (or other large civil structures), wind can generate a forcing frequency which resonates with the building, capable of causing damage if oscillation amplitudes are large enough. In engines or other periodic forcing machines it's important to make sure none of the other components have the same natural frequency as the forcing, otherwise vibrations could be amplified.\n\n**Beats** occur when the forcing frequency is close to the natural frequency. Because the forcing frequency and natural frequency of the system are slightly different, forces slowly go from in phase (amplification) to out of phase (cancelation), generating low frequency beats. Guitar tuning utilizes this feature. When you tune a guitar, you listen for beats (slow pulsing) that happens when the string and a reference note are slightly different in frequency. As you tune closer, the beat rate slows, and when the beats nearly disappear the pitches match.\n\n### Damped\n\nZero damping is unrealistic. Real systems have some amount of damping. In this section we'll introduce damping to the forced system and how it affects resonance.\n\nWith damping we will be solving\n$$\nm \\ddot{y} + c\\dot{y} + k y = f_0 \\cos \\omega_f t\n$$ {#eq-gov-eq-forced-undamped}\nand again the solution has homogeneous and particular parts. The particular solution is the same as the undamped case, @eq-particular-solution. The homogeneous solution is the same as the unforced underdamped solution, @eq-unforced-underdamped-sol. \n\nWe repeat the process as was done in the undamped case and get the general solution\n$$\ny(t) = y_h(t) + y_p(t)\n$$\nwhere\n$$\ny_h = e^{-\\omega_n \\zeta t} \\left( a_1 \\cos \\omega_d t + a_2 \\sin \\omega_d t \\right),\n$$\nwith $a_1$ and $a_2$ determined from initial conditions and\n$$\ny_p = b_1 \\cos{\\omega_f t} + b_2 \\sin{\\omega_f t}\n$$\nwith the coefficients\n$$\nb_1 = \\frac{(f_0/k)(1-r^2)}{(1-r^2)^2 + (2\\zeta r)^2}, \\quad b_2 = \\frac{(f_0/k)(2\\zeta r)}{(1-r^2)^2 + (2\\zeta r)^2}\n$$\nand $r=\\omega_f/\\omega_n$ is the frequency ratio.\n\nNote now $y_h$ decays to zero as $t\\to \\infty$ as opposed to the undamped case where $y_h$ is an undecaying sinusoid. This means that for long times (on the order $t>3\\zeta \\omega_n$) after the initial motion the particular solution will dominate. Therefore, when considering damped resonance it is useful to only consider the particular solution and its maximum amplitude. This is often called **practical resonance**.\n\nWe can understand practical resonance by rewriting the particular solution (using trigonometric identities) as\n$$\ny_p = A \\cos (\\omega_f t - \\phi)\n$$\nwhere $A$ is the **amplitude** of $y_p$ and $\\phi$ is the **phase angle** or **phase lag** because it measures the lag of the output behind the input. These are evaluated as\n$$\nA = \\sqrt{b_1^2 + b_2^2} = \\frac{f_0/m}{\\sqrt{(1-r^2)^2 + (2\\zeta r)^2}}, \\quad \\tan \\phi = \\frac{b_2}{b_1} = \\frac{2\\zeta r}{1-r^2}.\n$$\n\nLet's now see how the response amplitude and phase are influenced by damping and forcing frequency via an interactive demo. The figure on the left plots amplitude versus the frequency ration $\\omega_f/\\omega_n$. The response amplitude is normalized by the steady forcing displacement ($f_0/k$) and so a value greater than one corresponds with amplification relative to the input. \n\n<iframe class=\"quiz-iframe\"\n        src=\"interact-msd-resonance-damped-amplitude-phase.html\"\n        style=\"width:100%; height:1px; border:0; display:block; margin:0 auto; overflow:hidden;\"\n        loading=\"lazy\"\n        scrolling=\"no\"></iframe>\n\n<iframe src=\"qdeck-resonance-damped/qdeck-resonance-damped.html\"\n        class=\"quiz-iframe\"\n        style=\"width:100%; border:0;\"\n        loading=\"lazy\"></iframe>\n\n<!-- As $\\zeta$ increases, what happens to the height of the resonance peak?\nAs $\\zeta$ increases, what happens to the width of the resonance peak?\nWhat value of $\\zeta$ is there no longer a resonance peak? answer = 0.707\nWhat is the phase lag for $r\\ll 1$?\n- quasi-steady: $ky = f$\nWhat is the phase lag for $r=1$?\n- 90 degrees because the force is aligned with velocity/damping, making energy transfer most effective\n- $cy' = f$ \nWhat is the phase lag for $r>>1$?\n- inertia dominated $my'' = f$ -->"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":true,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"css":["../../styles.css","../../assets/quiz/quiz.css"],"include-after-body":["../../tooltips.html","../../_includes/quiz-iframe-resize.html"],"html-math-method":"katex","output-file":"msd.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.8.27","theme":"flatly","code-copy":true,"title":"Mass-Spring-Damper System"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}